
<!doctype html>
<html>
<head><meta charset="utf-8"/><title>Batch Prediction</title></head>
<body>
  <h1>Batch Prediction Upload</h1>
  <form id="upload" enctype="multipart/form-data" method="post">
    <input type="file" name="file" accept=".csv"/>
    <button type="submit">Upload & Predict</button>
  </form>
  <div id="result"></div>
  <script>
    document.getElementById('upload').addEventListener('submit', async function(e){
      e.preventDefault();
      const f = document.querySelector('input[type=file]').files[0];
      const fd = new FormData();
      fd.append('file', f);
      const res = await fetch('/ml/batch',{method:'POST', body: fd});
      if(res.ok){
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'batch_predictions.csv'; document.body.appendChild(a); a.click();
        a.remove();
      } else {
        const txt = await res.text();
        document.getElementById('result').innerText = txt;
      }
    });
  </script>
</body>
</html>
